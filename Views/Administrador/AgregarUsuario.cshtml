
@{
    ViewBag.Title = "AgregarUsuario";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

@Scripts.Render("~/bundles/Register")
<section class="vh-100" style="background-color: #eee;">
    <div class="container h-100">
        <div class="row d-flex justify-content-center align-items-center h-100">
            <div class="col-lg-12 col-xl-11">
                <div class="card text-black" style="border-radius: 25px;">
                    <div class="card-body p-md-5">
                        <div class="row justify-content-center">
                            <div class="col-md-10 col-lg-6 col-xl-5 order-2 order-lg-1">

                                <p class="text-center h1 fw-bold mb-5 mx-1 mx-md-4 mt-4">Sign up</p>

                                <form action='@Url.Action("RegistrarUsuarioExterno", "Home")' method="post" class="mx-1 mx-md-4 mb-4" id="registration-form">
                                    <span class="error-message" id="confirm-password-error-message"></span>
                                    <div class="d-flex flex-row align-items-center mb-4">

                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="text" name="nombre" id="name" class="form-control" placeholder="Nombre " required />
                                            <label class="form-label" for="name">Nombre</label>
                                            <div class="invalid-feedback">
                                                Por favor ingresa tu nombre.
                                            </div>
                                        </div>

                                    </div>

                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="text" name="apellido1" id="firstLastName" class="form-control" placeholder="Primer Apellido" required />
                                            <label class="form-label" for="firstLastName">Primer Apellido</label>
                                            <div class="invalid-feedback">
                                                Por favor Ingresa tu primer apellido.
                                            </div>
                                        </div>

                                    </div>


                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="text" name="apellido2" id="secondLastName" class="form-control" placeholder="Segundo Apellido" required />
                                            <label class="form-label" for="secondLastName">Segundo Apellido</label>
                                            <div class="invalid-feedback">
                                                Por favor Ingresa tu segundo apellido.
                                            </div>
                                        </div>

                                    </div>

                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="tel" name="numeroTelefono" id="phone" class="form-control" placeholder="Teléfono" required />
                                            <label class="form-label" for="phone">Teléfono</label>
                                            <div class="form-text text-muted">Sin guiones ni espacios.</div>

                                            <div class="invalid-feedback" id="invalid-numerl-tel">

                                            </div>
                                        </div>

                                    </div>
                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="email" id="email" name="correo" class="form-control" placeholder="Correo Electrónico" required />
                                            <label class="form-label" for="email">Correo Electrónico</label>
                                            <div class="invalid-feedback" id="invalid-email">

                                            </div>
                                        </div>

                                    </div>
                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="number" id="ced" name="cedula" class="form-control" placeholder="Cédula de identidad" required />
                                            <label class="form-label" for="ced">Cédula de identidad</label>
                                            <div class="form-text text-muted">Sin guiones ni espacios, mínimo 9 carácteres.</div>
                                            <div class="invalid-feedback" id="invalid-ced">

                                            </div>
                                        </div>

                                    </div>
                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="password" id="password" name="contrasena" class="form-control" placeholder="Contraseña" required title="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un número" />
                                            <label class="form-label" for="password">Contraseña</label>
                                            <div class="form-text text-muted">Minimo 8 caracteres, 1 minúscula, 1 mayúscula, 1 número</div>
                                            <div class="invalid-feedback" id="invalid-password">
                                                Por favor ingresa tu contraseña
                                            </div>
                                        </div>

                                    </div>
                                    <div class="d-flex flex-row align-items-center mb-4 form-floating">
                                        <div class=" flex-fill mb-0 form-floating">
                                            <input type="password" id="confirm-password" class="form-control" placeholder="Confirmar Contraseña" required />
                                            <label class="form-label" for="confirm-password">Confirmar Contraseña</label>
                                            <div class="invalid-feedback" id="invalid-password2">

                                            </div>
                                        </div>

                                    </div>

                                    <div class="d-flex justify-content-center mx-4 mb-3 mb-lg-4">
                                        <button type="button" class="btn btn-primary btn-lg" id="registration-btn">Registrarse</button>
                                    </div>

                                </form>

                            </div>
                            <div class="col-md-10 col-lg-6 col-xl-7 d-flex align-items-center order-1 order-lg-2">

                                <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-registration/draw1.webp"
                                     class="img-fluid" alt="Sample image">

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.getElementById("registration-btn").onclick = function () {
        // Obtener los valores de los campos del formulario
        var name = document.getElementById("name").value;
        var firstLastName = document.getElementById("firstLastName").value;
        var secondLastName = document.getElementById("secondLastName").value;
        var phone = document.getElementById("phone").value;
        var email = document.getElementById("email").value;
        var ced = document.getElementById("ced").value;
        var password = document.getElementById("password").value;
        var confirmPassword = document.getElementById("confirm-password").value;

        // Validar los campos requeridos
        var errorMessage = "";
        if (name == "") {
            errorMessage += "Debe ingresar su nombre.\n";
        }
        if (firstLastName == "") {
            errorMessage += "Debe ingresar su primer apellido.\n";
        }
        if (secondLastName == "") {
            errorMessage += "Debe ingresar su segundo apellido.\n";
        }
        if (phone == "") {
            errorMessage += "Debe ingresar su número de teléfono.\n";
        } else if (!esNumeroTelefonico(phone)) {
            errorMessage += "Debe ingresar un número de teléfono valido.\n";
        }
        if (email == "") {
            errorMessage += "Debe ingresar su correo electrónico.\n";
        } else if (!esCorreo(email)) {
            errorMessage += "Debe ingresar una dirección de correo valida.\n";
        }
        if (ced == "") {
            errorMessage += "Debe ingresar su número de cédula.\n";
        } else if (!esCedula(ced)) {
            errorMessage += "Debe ingresar un cédula valida.\n";
        }
        if (password == "") {
            errorMessage += "Debe ingresar una contraseña.\n";
        } else if (!esContrasena(password)) {
            errorMessage += "Debe ingresar una contraseña valida que contenga :.\n al menos 8 caracteres \n al menos 1 letra minúscula \n al menos 1 letra mayúscula \n al menos 1 número";
        } else if (confirmPassword == "") {
            errorMessage += "Debe confirmar su contraseña.\n";
        } else if (confirmPassword !== password) {
            errorMessage += "La contraseñas no coinciden.\n";
        }

        // Mostrar el mensaje de error o enviar el formulario
        if (errorMessage != "") {
            alert(errorMessage);
        } else {
            document.getElementById("registration-form").submit();
        }
    };


    const name = document.getElementById("name");
    name.addEventListener("blur", function () {
        if (!name.value) {
            name.classList.add("is-invalid");
        } else {
            name.classList.remove("is-invalid");
        }
    });
    const firstLastName = document.getElementById("firstLastName");
    firstLastName.addEventListener("blur", function () {
        if (!firstLastName.value) {
            firstLastName.classList.add("is-invalid");
        } else {
            firstLastName.classList.remove("is-invalid");
        }
    });
    const secondLastName = document.getElementById("secondLastName");
    secondLastName.addEventListener("blur", function () {
        if (!secondLastName.value) {
            secondLastName.classList.add("is-invalid");
        } else {
            secondLastName.classList.remove("is-invalid");
        }
    });



    function esNumeroTelefonico(numero) {
        const regex = /^\d{8}$/;
        return regex.test(numero);
    }

    const phone = document.getElementById("phone");
    const errorTelefono = document.getElementById("invalid-numerl-tel");
    phone.addEventListener("blur", function () {
        if (!phone.value) {
            phone.classList.add("is-invalid");
            errorTelefono.textContent = "Por favor ingrese un número de teléfono"
        } else if (!esNumeroTelefonico(phone.value)) {
            phone.classList.add("is-invalid");
            errorTelefono.textContent = "Por favor ingrese un número de teléfono valido, formato: XXXXXXX)"
        } else {
            phone.classList.remove("is-invalid");
        }
    });

    const email = document.getElementById("email");
    const errorCorreo = document.getElementById("invalid-email");
    email.addEventListener("blur", function () {
        if (!email.value) {
            email.classList.add("is-invalid");
            errorCorreo.textContent = "Por favor ingrese un correo electrónico valido"
        } else if (!esCorreo(email.value)) {
            email.classList.add("is-invalid");
            errorCorreo.textContent = "Por favor ingrese un correo electrónico valido"
        } else {
            email.classList.remove("is-invalid");
        }
    });

    const ced = document.getElementById("ced");
    const errorCed = document.getElementById("invalid-ced");
    ced.addEventListener("blur", function () {
        if (!ced.value) {
            ced.classList.add("is-invalid");
            errorCed.textContent = "Por favor su cedula de identidad"
        } else if (!esCedula(ced.value)) {
            ced.classList.add("is-invalid");
            errorCed.textContent = "Por favor ingrese una cedula de identidad valida, sin espacios ni guiones"
        } else {
            ced.classList.remove("is-invalid");
        }
    });

    const password = document.getElementById("password");
    const errorPassword = document.getElementById("invalid-password");
    password.addEventListener("blur", function () {
        if (!password.value) {
            errorPassword.textContent = "Por favor digite su contraseña"
            password.classList.add("is-invalid");
        } else if (!esContrasena(password.value)) {
            password.classList.add("is-invalid");
            errorPassword.textContent ="La contraseña debe tener al menos 8 caracteres, una mayúscula, una minúscula y un número"
        } else {
            password.classList.remove("is-invalid");
        }
    });

    const confirmPassword = document.getElementById("confirm-password");
    const errorPassword2 = document.getElementById("invalid-password2");
    confirmPassword.addEventListener("blur", function () {
        if (!confirmPassword.value) {
            confirmPassword.classList.add("is-invalid");
            errorPassword2.textContent = "Por vafor confirme la contraseña"
        } else if (confirmPassword.value !== password.value) {
            confirmPassword.classList.add("is-invalid");
            errorPassword2.textContent = "Las contraseñas no coinciden"
        } else {
            confirmPassword.classList.remove("is-invalid");
        }
    });



</script>


